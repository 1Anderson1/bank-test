databaseChangeLog:
  - logicalFilePath: 20230213.1-init-db.yaml
  - changeSet:
      -preConditions:
        - onFail: MARK_RAN
        - not:
            - tableExists:
                tableName: USER
      id: 2023-02-13-1
      author: Boikov
      changes:
        - createTable:
            tableName: USER
            schemaName: public
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
                    unique: true
              - column:
                  name: date_of_birth
                  type: DATE
              - column:
                  name: name
                  type: VARCHAR(500)
              - column:
                  name: password
                  type: VARCHAR(500)
  - changeSet:
      -preConditions:
        - onFail: MARK_RAN
        - not:
            - tableExists:
                tableName: ACCOUNT
            - tableExists:
                tableName: EMAIL_DATA
            - tableExists:
                tableName: PHONE_DATA
      id: 2023-02-13-2
      author: Boikov
      changes:
        - createTable:
            tableName: ACCOUNT
            schemaName: public
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
                    unique: true
              - column:
                  name: user_id
                  type: BIGINT
              - column:
                  name: balance
                  type: DECIMAL
                  defaultValueNumeric: 0.0
        - createTable:
            tableName: EMAIL_DATA
            schemaName: public
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    unique: true
                    primaryKey: true
                    nullable: false
              - column:
                  name: user_id
                  type: BIGINT
              - column:
                  name: email
                  type: VARCHAR(200)
                  constraints:
                    unique: true
        - createTable:
            tableName: PHONE_DATA
            schemaName: public
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    unique: true
                    primaryKey: true
                    nullable: false
              - column:
                  name: user_id
                  type: BIGINT
              - column:
                  name: phone
                  type: VARCHAR(13)
                  constraints:
                    unique: true
              - addForeignKeyConstraint:
                  constraintName: fk_account_user_id
                  baseTableName: ACCOUNT
                  baseColumnNames: user_id
                  referencedTableName: USER
                  referencedColumnNames: id
              - addForeignKeyConstraint:
                  constraintName: fk_email_data_user_id
                  baseTableName: EMAIL_DATA
                  baseColumnNames: user_id
                  referencedTableName: USER
                  referencedColumnNames: id
              - addForeignKeyConstraint:
                  constraintName: fk_phone_data_user_id
                  baseTableName: PHONE_DATA
                  baseColumnNames: user_id
                  referencedTableName: USER
                  referencedColumnNames: id